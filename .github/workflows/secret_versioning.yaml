name: Update Version

on:
  push:
    branches:
      - feature/CB2-10972

jobs:
  update_version:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Update Version
      run: |
        if [ "${{ github.event_name }}" == "push" ] && [ "${{ github.ref }}" == "refs/heads/feature/CB2-10972" ]; then
       
          export AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID
          export AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY

          SECRET_JSON=$(aws secretsmanager put-secret-value --secret-id develop/version --secret-string "0.1234.0")

          NEXT_RELEASE_VERSION=$(echo "$SECRET_JSON" | jq -r .version) >> $GITHUB_ENV

          echo "Version retrieved: ${NEXT_RELEASE_VERSION}"

        fi
      env:
        AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
        AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}


    
        

